{"mappings":"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","sources":["index.js"],"sourcesContent":["import { uploadScore, login, nowGroupId, auth } from \"./firebase.js\";\nimport { onAuthStateChanged } from \"firebase/auth\";\nimport { Modal } from \"./assets/js/bootstrap.esm.min.js\";\n\nexport var loginState = 0;\nvar isTeacher = 0;\nconst UUID = _uuid();\n\nfunction _uuid() {\n  var d = Date.now();\n  if (\n    typeof performance !== \"undefined\" &&\n    typeof performance.now === \"function\"\n  ) {\n    d += performance.now();\n  }\n  return \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, function (c) {\n    var r = (d + Math.random() * 16) % 16 | 0;\n    d = Math.floor(d / 16);\n    return (c === \"x\" ? r : (r & 0x3) | 0x8).toString(16);\n  });\n}\n\nconst a = $(\"#ratingSubmit\").click((e) => {\n  e.preventDefault();\n  $(\"input:radio:checked\", this)\n    .parent()\n    .parent()\n    .parent()\n    .removeClass(\"error\");\n  let score;\n  if (!loginState)\n    score =\n      $(\"input[name=rating0]:checked\").val() * 5 +\n      $(\"input[name=rating1]:checked\").val() * 11 +\n      $(\"input[name=rating2]:checked\").val() * 3 +\n      $(\"input[name=rating3]:checked\").val() * 1;\n  else\n    score = \n      $(\"input#typeNumber0\").val() * 1+\n      $(\"input#typeNumber1\").val() * 1+\n      $(\"input#typeNumber2\").val() * 1+\n      $(\"input#typeNumber3\").val() * 1;\n  let tmpCookie;\n  if (!loginState)\n    tmpCookie =\n      $(\"input[name=rating0]:checked\").val() * 1000 +\n      $(\"input[name=rating1]:checked\").val() * 100 +\n      $(\"input[name=rating2]:checked\").val() * 10 +\n      $(\"input[name=rating3]:checked\").val() * 1;\n  else tmpCookie = \n      $(\"#typeNumber0\").val() * 1000000 +\n      $(\"#typeNumber1\").val() * 10000 +\n      $(\"#typeNumber2\").val() * 100 +\n      $(\"#typeNumber3\").val() * 1;\n  console.log(tmpCookie);\n  let group_id = nowGroupId;\n  if (!Number.isNaN(score)) {\n    console.log(group_id);\n    let identity;\n    if (loginState) {\n      identity = isTeacher ? 1 : 0;\n    } else {\n      identity = 2;\n    }\n    uploadScore(group_id, {\n      score: score,\n      comment: $(\"#comment\").val(),\n    }, identity);\n    console.log(tmpCookie);\n    $.cookie(`group${group_id}`, tmpCookie, { expires: 1 });\n    $.cookie(`group${group_id}_C`, $(\"#comment\").val(), { expires: 1 });\n    $(\"#msg\").html(\"評分成功\");\n    if(!loginState) {\n      $(\"input\").prop(\"disabled\", true);\n      $(\"textarea\").prop(\"disabled\", true);\n      $(\"#ratingSubmit\").prop(\"disabled\", true);\n    }\n  } else {\n    $(\"input:radio:not(:checked)\", this)\n      .parent()\n      .parent()\n      .parent()\n      .addClass(\"error\");\n    return false;\n  }\n});\n\nfunction hideModal() {\n  $(\"#loginModal\").removeClass(\"in\");\n  $(\".modal-backdrop\").remove();\n  $(\"body\").removeClass(\"modal-open\");\n  $(\"body\").css(\"padding-right\", \"\");\n  $(\"#loginModal\").hide();\n}\n\n$(\"#login\").submit((e) => {\n  e.preventDefault();\n  $(\"#loginBtn\").prop(\"disabled\", true);\n  $(\"#passwordInput\").prop(\"disabled\", true);\n  login($(\"#passwordInput\").val())\n    .then((res) => {\n      hideModal();\n    })\n    .catch((err) => {\n      $(\"#passwordInput\").addClass(\"is-invalid\");\n      $(\"#passwordInput\").focus();\n      console.log(err);\n    })\n    .finally(() => {\n      $(\"#loginBtn\").prop(\"disabled\", false);\n      $(\"#passwordInput\").prop(\"disabled\", false);\n    });\n});\n\nonAuthStateChanged(auth, (user) => {\n  if (user) {\n    isTeacher = user.email === \"fuyajoteacher0106!@fuyajo.tw\";\n    loginState = 1;\n    $(\"#loginNavBtn\").hide();\n    if (!isTeacher) $(\"#userName\").html(user.email);\n    else $(\"#userName\").html(\"馬尚彬 教授\");\n    $(\".star\").hide();\n    $(\".number\").show();\n    $(\"#dashborad\").show();\n    $(\"#beginRating\").hide();\n  } else {\n    $(\".number\").hide();\n    $(\".star\").show();\n    $(\"#loginNavBtn\").show();\n    $(\"#userName\").html(\"\");\n    $(\"#dashborad\").hide();\n    loginState = 0;\n  }\n});\n\nif ($.cookie(\"UUID\") === undefined) {\n  $.cookie(\"UUID\", UUID, { expires: 365 });\n}\n\n$(\"#uuid\").html(`You UUID is ${$.cookie(\"UUID\")}`);\n"],"names":["$a501d8345a242c58$export$b62c99b86bf1c4ae","$a501d8345a242c58$var$isTeacher","$a501d8345a242c58$var$UUID","d","Date","now","performance","replace","c","r","Math","random","floor","toString","$a501d8345a242c58$var$_uuid","$","click","e","score","tmpCookie","preventDefault","undefined","parent","removeClass","val","console","log","group_id","$8iwlJ","nowGroupId","Number","isNaN","addClass","identity","uploadScore","comment","cookie","expires","html","prop","submit","login","then","res","remove","css","hide","catch","err","focus","finally","$2DfF0","onAuthStateChanged","auth","user","email","show"],"version":3,"file":"index.f989c83b.js.map"}